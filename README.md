# myBlog - ç°ä»£åŒ–å¼‚æ­¥åšå®¢ç³»ç»Ÿ

åŸºäº FastAPI æ„å»ºçš„é«˜æ€§èƒ½å¼‚æ­¥åšå®¢åç«¯æœåŠ¡ï¼Œæ”¯æŒç”¨æˆ·è®¤è¯ã€å†…å®¹ç®¡ç†å’Œç®¡ç†å‘˜åå°ã€‚

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: FastAPI (å¼‚æ­¥Webæ¡†æ¶)
- **æ•°æ®åº“**: MySQL (é€šè¿‡ Tortoise ORM + aiomysql)
- **ç¼“å­˜**: Redis
- **è®¤è¯**: JWT + OAuth2
- **å¯†ç åŠ å¯†**: bcrypt
- **é‚®ä»¶æœåŠ¡**: SMTP (æ”¯æŒHTMLæ¨¡æ¿)

## é¡¹ç›®ç»“æ„

```
myBlog/
â”œâ”€â”€ app/                          # åº”ç”¨ä¸»ç›®å½•
â”‚   â”œâ”€â”€ admin_ui/templates/       # ç®¡ç†å‘˜ç•Œé¢æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ admin.html           # ç®¡ç†åå°ä¸»é¡µ
â”‚   â”‚   â”œâ”€â”€ articles.html        # æ–‡ç« ç®¡ç†é¡µé¢
â”‚   â”‚   â”œâ”€â”€ config.html          # é…ç½®ç®¡ç†é¡µé¢
â”‚   â”‚   â”œâ”€â”€ login.html           # ç™»å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ overview.html        # æ¦‚è§ˆé¡µé¢
â”‚   â”‚   â”œâ”€â”€ roles.html           # è§’è‰²ç®¡ç†é¡µé¢
â”‚   â”‚   â””â”€â”€ users.html           # ç”¨æˆ·ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ middlewares/              # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ error_handler.py     # é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ routers/                  # è·¯ç”±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ admin.py             # ç®¡ç†å‘˜åå°è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ api_articles.py      # æ–‡ç« ç®¡ç†API
â”‚   â”‚   â”œâ”€â”€ api_config.py        # é…ç½®ç®¡ç†API
â”‚   â”‚   â”œâ”€â”€ api_users.py         # ç”¨æˆ·ç®¡ç†API
â”‚   â”‚   â”œâ”€â”€ articles.py          # æ–‡ç« ç›¸å…³è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.py              # è®¤è¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ comments.py          # è¯„è®ºè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ likes.py             # ç‚¹èµ/æ”¶è—è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ roles.py             # è§’è‰²ç®¡ç†è·¯ç”±
â”‚   â”‚   â””â”€â”€ users.py             # ç”¨æˆ·è·¯ç”±
â”‚   â”œâ”€â”€ utils/                    # å·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ code.py              # éªŒè¯ç ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ email.py             # é‚®ä»¶å‘é€
â”‚   â”‚   â”œâ”€â”€ email_changepwd.html # ä¿®æ”¹å¯†ç é‚®ä»¶æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ email_verification.html # é‚®ç®±éªŒè¯æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ logger.py            # æ—¥å¿—é…ç½®
â”‚   â”‚   â”œâ”€â”€ rate_limiter.py      # é™æµå™¨
â”‚   â”‚   â”œâ”€â”€ redis_client.py      # Rediså®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ security.py          # å®‰å…¨å·¥å…·(JWT,å¯†ç åŠ å¯†)
â”‚   â”‚   â””â”€â”€ user_utils.py        # ç”¨æˆ·å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ config.py                 # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ database.py               # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ deps.py                   # ä¾èµ–æ³¨å…¥
â”‚   â”œâ”€â”€ main.py                   # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ models.py                 # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ schemas.py                # Pydanticæ¨¡å¼
â”œâ”€â”€ migrations/models/            # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”œâ”€â”€ requirements.txt              # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ pyproject.toml               # é¡¹ç›®é…ç½®
â””â”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. ç¯å¢ƒé…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
DATABASE_URL=mysql://username:password@localhost:3306/myblog
SECRET_KEY=your-super-secret-jwt-key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REDIS_URL=redis://localhost:6379/0
SMTP_SERVER=smtp.example.com
SMTP_PORT=587
SMTP_USER=your_email@example.com
SMTP_PASSWORD=your_password
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘ç¯å¢ƒ
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# ç”Ÿäº§ç¯å¢ƒ
uvicorn app.main:app --workers 4 --host 0.0.0.0 --port 8000
```

è®¿é—® `http://localhost:8000/docs` æŸ¥çœ‹ API æ–‡æ¡£

## API ç«¯ç‚¹åˆ—è¡¨

### ğŸ” è®¤è¯ç›¸å…³ (`/auth`)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | é™æµ |
|------|------|------|------|
| POST | `/auth/register` | ç”¨æˆ·æ³¨å†Œ | 3æ¬¡/åˆ†é’Ÿ |
| POST | `/auth/login` | ç”¨æˆ·ç™»å½• | - |
| POST | `/auth/reset-password` | é‡ç½®å¯†ç  | - |
| POST | `/auth/send-code` | å‘é€éªŒè¯ç  | - |

### ğŸ‘¤ ç”¨æˆ·ç®¡ç† (`/users`)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| GET | `/users/me` | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ | ç™»å½•ç”¨æˆ· |
| PUT | `/users/me` | æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | ç™»å½•ç”¨æˆ· |
| GET | `/users/me/avatar` | ä¸Šä¼ å¤´åƒ | ç™»å½•ç”¨æˆ· |
| POST | `/users/change_password` | ä¿®æ”¹å¯†ç  | ç™»å½•ç”¨æˆ· (3æ¬¡/åˆ†é’Ÿ) |

### ğŸ“ æ–‡ç« ç®¡ç† (`/articles`)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| POST | `/articles/` | åˆ›å»ºæ–‡ç«  | ç™»å½•ç”¨æˆ· |
| PUT | `/articles/{article_id}` | æ›´æ–°æ–‡ç«  | æ–‡ç« ä½œè€… |
| DELETE | `/articles/{article_id}` | åˆ é™¤æ–‡ç«  | æ–‡ç« ä½œè€… |
| GET | `/articles/` | æ–‡ç« åˆ—è¡¨(åˆ†é¡µ) | å…¬å¼€ |
| GET | `/articles/{article_id}` | æ–‡ç« è¯¦æƒ… | å…¬å¼€ |
| GET | `/articles/search` | æœç´¢æ–‡ç«  | å…¬å¼€ |

### ğŸ’¬ è¯„è®ºç³»ç»Ÿ (`/comments`)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| POST | `/comments/` | å‘è¡¨è¯„è®º | ç™»å½•ç”¨æˆ· |
| GET | `/comments/article/{article_id}` | è·å–æ–‡ç« è¯„è®º | å…¬å¼€ |

### â¤ï¸ äº’åŠ¨åŠŸèƒ½ (`/interactions`)

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| POST | `/interactions/article/{article_id}/like` | ç‚¹èµ/å–æ¶ˆç‚¹èµæ–‡ç«  | ç™»å½•ç”¨æˆ· |
| POST | `/interactions/comment/{comment_id}/like` | ç‚¹èµ/å–æ¶ˆç‚¹èµè¯„è®º | ç™»å½•ç”¨æˆ· |
| POST | `/interactions/article/{article_id}/favorite` | æ”¶è—/å–æ¶ˆæ”¶è—æ–‡ç«  | ç™»å½•ç”¨æˆ· |

### ğŸ› ï¸ ç®¡ç†å‘˜åŠŸèƒ½ (`/admin`)

#### åå°é¡µé¢
| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| GET | `/admin/` | ç®¡ç†åå°é¦–é¡µ | ç®¡ç†å‘˜ |
| GET | `/admin/verify` | éªŒè¯ç®¡ç†å‘˜æƒé™ | ç®¡ç†å‘˜ |
| GET | `/admin/users_page` | ç”¨æˆ·ç®¡ç†é¡µé¢ | ç®¡ç†å‘˜ |
| GET | `/admin/articles_page` | æ–‡ç« ç®¡ç†é¡µé¢ | ç®¡ç†å‘˜ |

#### æ•°æ®ç»Ÿè®¡
| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| GET | `/admin/api/stats` | åå°ç»Ÿè®¡æ•°æ® | ç®¡ç†å‘˜ |
| GET | `/admin/api/recent-logs` | æœ€è¿‘æ“ä½œæ—¥å¿— | ç®¡ç†å‘˜ |

#### ç”¨æˆ·ç®¡ç†API (`/admin/api/users`)
| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| GET | `/admin/api/users/` | ç”¨æˆ·åˆ—è¡¨(åˆ†é¡µ/æœç´¢) | ç®¡ç†å‘˜ |
| POST | `/admin/api/users/` | åˆ›å»ºç”¨æˆ· | ç®¡ç†å‘˜ |
| PUT | `/admin/api/users/{user_id}` | æ›´æ–°ç”¨æˆ· | ç®¡ç†å‘˜ |
| PATCH | `/admin/api/users/{user_id}/status` | æ›´æ–°ç”¨æˆ·çŠ¶æ€ | ç®¡ç†å‘˜ |
| DELETE | `/admin/api/users/{user_id}` | åˆ é™¤ç”¨æˆ· | ç®¡ç†å‘˜ |
| GET | `/admin/api/users/export` | å¯¼å‡ºç”¨æˆ·Excel | ç®¡ç†å‘˜ |

#### æ–‡ç« ç®¡ç†API (`/admin/api/articles`)
| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| GET | `/admin/api/articles/` | æ–‡ç« åˆ—è¡¨ | ç®¡ç†å‘˜ |
| POST | `/admin/api/articles/` | åˆ›å»ºæ–‡ç«  | ç®¡ç†å‘˜ |
| PUT | `/admin/api/articles/{article_id}` | æ›´æ–°æ–‡ç«  | ç®¡ç†å‘˜ |
| DELETE | `/admin/api/articles/{article_id}` | åˆ é™¤æ–‡ç«  | ç®¡ç†å‘˜ |

#### è§’è‰²ç®¡ç†API (`/admin/api/roles`)
| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| GET | `/admin/api/roles/` | è§’è‰²åˆ—è¡¨ | ç®¡ç†å‘˜ |
| POST | `/admin/api/roles/` | åˆ›å»ºè§’è‰² | ç®¡ç†å‘˜ |
| PUT | `/admin/api/roles/{role_id}` | æ›´æ–°è§’è‰² | ç®¡ç†å‘˜ |
| DELETE | `/admin/api/roles/{role_id}` | åˆ é™¤è§’è‰² | ç®¡ç†å‘˜ |

#### é…ç½®ç®¡ç†API (`/admin/api/config`)
| æ–¹æ³• | ç«¯ç‚¹ | æè¿° | æƒé™è¦æ±‚ |
|------|------|------|----------|
| GET | `/admin/api/config/` | é…ç½®åˆ—è¡¨ | ç®¡ç†å‘˜ |
| POST | `/admin/api/config/` | åˆ›å»ºé…ç½® | ç®¡ç†å‘˜ |
| PUT | `/admin/api/config/{config_id}` | æ›´æ–°é…ç½® | ç®¡ç†å‘˜ |

### ğŸŒ å…¶ä»–ç«¯ç‚¹

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| GET | `/` | APIæ ¹è·¯å¾„ |
| GET | `/login` | ç™»å½•é¡µé¢ |
| GET | `/hello/{name}` | é—®å€™æ¥å£ |
| GET | `/docs` | Swagger APIæ–‡æ¡£ |

## ç‰¹æ€§

- âœ… **å¼‚æ­¥æ¶æ„**: åŸºäºFastAPIçš„å®Œå…¨å¼‚æ­¥æ“ä½œ
- âœ… **JWTè®¤è¯**: å®‰å…¨çš„ç”¨æˆ·èº«ä»½éªŒè¯
- âœ… **é‚®ç®±éªŒè¯**: æ³¨å†Œå’Œå¯†ç é‡ç½®é‚®ç®±éªŒè¯
- âœ… **é™æµä¿æŠ¤**: é˜²æ­¢æ¥å£æ»¥ç”¨
- âœ… **ç®¡ç†åå°**: å®Œæ•´çš„Webç®¡ç†ç•Œé¢
- âœ… **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒå¤´åƒä¸Šä¼ 
- âœ… **æ•°æ®å¯¼å‡º**: Excelæ ¼å¼æ•°æ®å¯¼å‡º
- âœ… **æœç´¢åŠŸèƒ½**: æ–‡ç« å†…å®¹æœç´¢
- âœ… **è¯„è®ºç³»ç»Ÿ**: å¤šçº§è¯„è®ºæ”¯æŒ
- âœ… **äº’åŠ¨åŠŸèƒ½**: ç‚¹èµã€æ”¶è—ç³»ç»Ÿ
- âœ… **è§’è‰²ç®¡ç†**: çµæ´»çš„æƒé™æ§åˆ¶

## å¼€å‘è¯´æ˜

- æ•°æ®åº“è¿ç§»ä½äº `migrations/models/` ç›®å½•
- é™æ€æ–‡ä»¶ä¸Šä¼ è‡³ `uploads/` ç›®å½•
- ç®¡ç†åå°è®¿é—®: `/admin/`
- APIæ–‡æ¡£åœ°å€: `/docs` æˆ– `/redoc`

## è®¸å¯è¯

MIT License