{% extends "public/base.html" %}

{% block title %}财经新闻 - 五市信息平台{% endblock %}

{% block extra_css %}
<style>
    /* 页面整体动画 */
    .fade-in {
        animation: fadeInUp 0.6s ease-out;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* 市场总结卡片 - 特殊样式 */
    .market-summary-card {
        background: linear-gradient(135deg, var(--primary-color) 0%, rgba(59, 130, 246, 0.9) 100%);
        color: white;
        border: none;
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2.5rem;
        position: relative;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .market-summary-card::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -20%;
        width: 200px;
        height: 200px;
        background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
        border-radius: 50%;
    }

    .market-summary-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
    }

    .market-summary-title {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 1rem;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .market-summary-content {
        font-size: 1.1rem;
        line-height: 1.6;
        opacity: 0.95;
    }

    .market-summary-meta {
        margin-top: 1.5rem;
        padding-top: 1rem;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    /* 普通新闻卡片 */
    .news-card {
        background: white;
        border-radius: 15px;
        border: 1px solid #e2e8f0;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        margin-bottom: 1.5rem;
        overflow: hidden;
        position: relative;
    }

    .news-card::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--primary-gradient);
        transform: scaleX(0);
        transition: transform 0.3s ease;
    }

    .news-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        border-color: var(--primary-color);
    }

    .news-card:hover::after {
        transform: scaleX(1);
    }

    .news-card-body {
        padding: 1.5rem;
    }

    .news-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 0.75rem;
        line-height: 1.4;
        transition: color 0.3s ease;
    }

    .news-card:hover .news-title {
        color: var(--primary-color);
    }

    .news-content {
        color: #6b7280;
        line-height: 1.6;
        margin-bottom: 1rem;
    }

    .news-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.875rem;
        color: #9ca3af;
        border-top: 1px solid #f3f4f6;
        padding-top: 0.75rem;
    }

    .news-source {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .news-time {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    /* 加载动画 */
    .loading-skeleton {
        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
        border-radius: 8px;
        height: 1.5rem;
        margin-bottom: 0.5rem;
    }

    @keyframes loading {
        0% {
            background-position: 200% 0;
        }
        100% {
            background-position: -200% 0;
        }
    }

    /* 新闻卡片进入动画 */
    .news-card, .market-summary-card {
        opacity: 0;
        transform: translateY(30px);
        animation: slideInUp 0.6s ease forwards;
    }

    .market-summary-card {
        animation-delay: 0.1s;
    }

    .news-section:nth-child(2) .news-card:nth-child(1) {
        animation-delay: 0.2s;
    }

    .news-section:nth-child(2) .news-card:nth-child(2) {
        animation-delay: 0.3s;
    }

    .news-section:nth-child(2) .news-card:nth-child(3) {
        animation-delay: 0.4s;
    }

    .news-section:nth-child(3) .news-card:nth-child(1) {
        animation-delay: 0.5s;
    }

    .news-section:nth-child(3) .news-card:nth-child(2) {
        animation-delay: 0.6s;
    }

    @keyframes slideInUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* 更新指示器 */
    .update-indicator {
        display: inline-block;
        width: 8px;
        height: 8px;
        background: #10b981;
        border-radius: 50%;
        margin-right: 0.5rem;
        animation: pulse_indicator 2s infinite;
    }

    @keyframes pulse_indicator {
        0% {
            box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
        }
        70% {
            box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
        }
        100% {
            box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
        }
    }

    /* 刷新按钮 */
    .refresh-btn {
        background: var(--primary-gradient);
        border: none;
        border-radius: 25px;
        color: white;
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
        transition: all 0.3s ease;
    }

    .refresh-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        color: white;
    }

    .refresh-btn:hover .bi-arrow-clockwise {
        animation: rotate 0.5s ease-in-out;
    }

    @keyframes rotate {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }

    /* 分页样式 */
    .pagination .page-link {
        color: var(--primary-color);
        border: 1px solid #e2e8f0;
        padding: 0.75rem 1rem;
        margin: 0 0.25rem;
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .pagination .page-link:hover {
        background: var(--primary-color);
        border-color: var(--primary-color);
        color: white;
        transform: translateY(-2px);
    }

    .pagination .page-item.active .page-link {
        background: var(--primary-gradient);
        border-color: var(--primary-color);
    }

    /* 响应式调整 */
    @media (max-width: 768px) {
        .market-summary-card {
            padding: 1.5rem;
        }

        .news-card-body {
            padding: 1rem;
        }
    }

    /* 区块标题 */
    .section-title {
        font-size: 1.35rem;
        font-weight: 700;
        margin: 2.5rem 0 1.5rem;
        color: var(--primary-color);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .section-title i {
        font-size: 1.2rem;
    }

    /* 全球热点短讯样式 */
    .global-hot-item {
        font-size: 0.95rem;
        line-height: 1.4;
        transition: background-color 0.2s ease;
        margin-bottom: 1rem !important;
    }

    .global-hot-item:hover {
        background-color: #f8fafc;
    }

    .offcanvas_link {
        text-decoration: none;
    }

    /* Offcanvas 整体样式优化 */
    .offcanvas {
        --bs-offcanvas-bg: #ffffff;
        --bs-offcanvas-border-width: 0;
        --bs-offcanvas-box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        border-radius: 0 20px 20px 0 !important;
    }

    /* Offcanvas 头部 */
    .offcanvas-header {
        padding: 1.5rem 1.5rem 1rem;
        border-bottom: 1px solid #eef2f7;
        background: linear-gradient(to right, var(--primary-color), #4f46e5);
        color: white;
    }

    .offcanvas-title {
        font-size: 1.35rem;
        font-weight: 700;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    .offcanvas-header .btn-close {
        filter: invert(1) grayscale(100%) brightness(200%);
        opacity: 0.8;
        transition: opacity 0.2s ease;
    }

    .offcanvas-header .btn-close:hover {
        opacity: 1;
    }

    /* Offcanvas 主体内容 */
    .offcanvas-body {
        padding: 1.5rem;
        color: #374151;
        line-height: 1.7;
        font-size: 1rem;
        background-color: #fafbff;
    }

    .offcanvas-body p {
        margin-bottom: 1rem;
    }

    .offcanvas-body p:last-child {
        margin-bottom: 0;
    }

    /* 响应式：小屏设备圆角取消 */
    @media (max-width: 991.98px) {
        .offcanvas {
            border-radius: 0 !important;
        }
    }

    @media (min-width: 992px) {
        .offcanvas-start {
            width: 500px !important;
        }
    }

    .offcanvas {
        transition: transform 0.45s,
        opacity 0.45s ease-out !important;
    }

    /* 初始状态：隐藏在左侧 + 透明 */
    .offcanvas.offcanvas-start {
        transform: translateX(-100%);
        opacity: 0;
        visibility: hidden;
    }

    /* 显示时：滑入 + 显现 */
    .offcanvas.showing,
    .offcanvas.show:not(.hiding) {
        transform: translateX(0);
        opacity: 1;
        visibility: visible;
    }

    /* 隐藏过程中：平滑退出 */
    .offcanvas.hiding {
        transform: translateX(-100%);
        opacity: 0;
    }

    /* 确保内容在动画过程中可交互 */
    .offcanvas.show {
        pointer-events: auto;
    }

    /* 背景遮罩（Backdrop）也加淡入淡出 */
    .offcanvas-backdrop {
        background-color: rgba(0, 0, 0, 0.4) !important;
        transition: opacity 0.45s ease-out !important;
    }

    .market-summary-content {
        line-height: 1.6;
    }

    /* Markdown 内容样式 */
    .market-summary-content h1,
    .market-summary-content h2,
    .market-summary-content h3 {
        margin-top: 1rem;
        margin-bottom: 0.5rem;
        font-weight: 600;
    }

    .market-summary-content h1 {
        font-size: 1.4rem;
    }

    .market-summary-content h2 {
        font-size: 1.3rem;
    }

    .market-summary-content h3 {
        font-size: 1.2rem;
    }

    .market-summary-content p {
        margin-bottom: 0.75rem;
    }

    .market-summary-content ul,
    .market-summary-content ol {
        margin-bottom: 0.75rem;
        padding-left: 1.5rem;
    }

    .market-summary-content li {
        margin-bottom: 0.25rem;
    }

    .market-summary-content blockquote {
        border-left: 4px solid #ddd;
        padding-left: 1rem;
        margin-left: 0;
        color: #666;
        font-style: italic;
    }

    .market-summary-content code {
        background-color: #f8f9fa;
        padding: 0.2rem 0.4rem;
        border-radius: 0.25rem;
        font-size: 0.875em;
    }

    .market-summary-content pre {
        background-color: #f8f9fa;
        padding: 1rem;
        border-radius: 0.5rem;
        overflow-x: auto;
        margin-bottom: 1rem;
    }

    .market-summary-content pre code {
        background: none;
        padding: 0;
    }

    .market-summary-content table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1rem;
    }

    .market-summary-content table th,
    .market-summary-content table td {
        border: 1px solid #dee2e6;
        padding: 0.5rem;
        text-align: left;
    }

    .market-summary-content table th {
        background-color: #f8f9fa;
        font-weight: 600;
    }

    .pagination_nav {
        margin-top: 2rem !important;
    }

    /* 刷新提示框样式 */
    .toast-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1055;
    }

    .refresh-toast {
        background: linear-gradient(135deg, #3b82f6 50%, #4f46e5 100%);
        border: none;
        /*border-radius: 12px;*/
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        color: white;
        min-width: 250px;
        opacity: 0;
        transform: translateX(100px) scale(0.8) rotate(5deg);
        transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .refresh-toast .toast-body {
        padding: 1rem 1.25rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 500;
    }

    .refresh-toast .toast-body i {
        font-size: 1.1rem;
        transform: scale(0);
        transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s;
    }

    /* 进场动画 */
    .refresh-toast.show {
        opacity: 1;
        transform: translateX(0) scale(1) rotate(0deg);
    }

    .refresh-toast.show .toast-body i {
        transform: scale(1);
    }

    /* 退场动画 */
    .refresh-toast.hiding {
        opacity: 0;
        transform: translateX(100px) scale(0.8) rotate(-5deg);
        transition: all 0.4s cubic-bezier(0.64, 0.04, 0.85, 0.06);
    }

    .refresh-toast.hiding .toast-body i {
        transform: scale(0) rotate(-180deg);
        transition: transform 0.3s cubic-bezier(0.64, 0.04, 0.85, 0.06);
    }

    /* 进度条动画 */
    .toast-progress {
        position: absolute;
        bottom: 0;
        left: 0;
        height: 3px;
        background: linear-gradient(90deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.6) 100%);
        border-radius: 0 0 12px 12px;
        width: 100%;
        transform-origin: left center;
        animation: toastProgress 3s linear forwards;
    }

    @keyframes toastProgress {
        from {
            transform: scaleX(1);
            opacity: 1;
        }
        to {
            transform: scaleX(0);
            opacity: 0.5;
        }
    }

    /* 悬停效果 */
    .refresh-toast:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
    }


</style>
{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- 页面标题 -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="h3 mb-1" style="color: var(--primary-color); font-weight: 700;">
                <i class="bi bi-newspaper me-2"></i>财经新闻
            </h2>
            <p class="text-muted mb-0">阅读财经资讯，把握市场脉搏</p>
        </div>
        <div class="d-flex align-items-center">
            <small class="text-muted me-3">
                <span class="update-indicator"></span>
                当前时间：<span id="updateTime">{{ update_time }}</span>
            </small>
            <button class="btn refresh-btn" id="refreshNews">
                <i class="bi bi-arrow-clockwise me-1"></i>刷新
            </button>
        </div>
    </div>


    <!-- 两栏布局 -->
    <div class="row g-4">

        <div class="col-md-7">
            <h3 class="section-title">
                <i class="bi bi-lightning-charge"></i> 资讯快报
            </h3>
            <div class="news-section">
                {% if news2_list %}
                {% for news in news2_list %}
                <a class="offcanvas_link" data-bs-toggle="offcanvas" href="#offcanvasExample{{ loop.index }}"
                   aria-controls="offcanvasExample">
                    <div class="news-card mb-3">
                        <div class="news-card-body">
                            <h3 class="news-title">{{ news.title }}</h3>
                            <div class="news-content">
                                {{ news.content | truncate(80) }}
                            </div>
                            <div class="news-meta">
                                <div class="news-source">
                                    <i class="bi bi-building"></i>
                                    <!--                                <span>{{ news.source or '财经快报' }}</span>-->
                                </div>
                                <div class="news-time">
                                    <i class="bi bi-clock"></i>
                                    <span>{{ news.publish_time.strftime('%m-%d %H:%M') }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </a>
                <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample{{ loop.index }}"
                     aria-labelledby="offcanvasExampleLabel{{ loop.index }}">
                    <div class="offcanvas-header">
                        <h5 class="offcanvas-title" id="offcanvasExampleLabel">{{ news.title }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body">
                        <div>
                            &nbsp;&nbsp;&nbsp;&nbsp;{{ news.content }}
                        </div>
                    </div>
                </div>

                {% endfor %}
                {% endif %}  <!-- 这里添加了缺失的 endif -->
            </div>

            <!-- 添加分页-->
            {% if pagination and pagination.total_pages > 1 %}
            <nav class="pagination_nav" aria-label="Page navigation example" style="font-size: small;">
                <ul class="pagination justify-content-end">
                    {# 首页 #}
                    <li class="page-item {% if pagination.page == 1 %}disabled{% endif %}">
                        <a class="page-link"
                           href="{% if pagination.page != 1 %}?page=1&per_page={{ pagination.per_page }}{% else %}#{% endif %}"
                           aria-label="First"
                        >
                            首页
                        </a>
                    </li>

                    {# 上一页 #}
                    <li class="page-item {% if not pagination.has_prev %}disabled{% endif %}">
                        <a class="page-link"
                           href="{% if pagination.has_prev %}?page={{ pagination.prev_num }}&per_page={{ pagination.per_page }}{% else %}#{% endif %}"
                           aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>

                    {# 页码数字 #}
                    {% for page_num in pagination.iter_pages() %}
                    {% if page_num %}
                    <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
                        <a class="page-link" href="?page={{ page_num }}&per_page={{ pagination.per_page }}">
                            {{ page_num }}
                        </a>
                    </li>
                    {% else %}
                    <li class="page-item disabled">
                        <span class="page-link">...</span>
                    </li>
                    {% endif %}
                    {% endfor %}

                    {# 下一页 #}
                    <li class="page-item {% if not pagination.has_next %}disabled{% endif %}">
                        <a class="page-link"
                           href="{% if pagination.has_next %}?page={{ pagination.next_num }}&per_page={{ pagination.per_page }}{% else %}#{% endif %}"
                           aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>

                    {# 尾页 #}
                    <li class="page-item {% if pagination.page == pagination.total_pages %}disabled{% endif %}">
                        <a class="page-link"
                           href="{% if pagination.page != pagination.total_pages %}?page={{ pagination.total_pages }}&per_page={{ pagination.per_page }}{% else %}#{% endif %}"
                           aria-label="Last">
                            尾页
                        </a>
                    </li>
                </ul>
            </nav>

            {% endif %}
        </div>

        <!-- 右侧：市场总结 + 全球热点 -->
        <div class="col-md-5">
            <!-- 市场总结 -->
            <div class="market-summary-card mb-4">
                <div class="market-summary-title">
                    <i class="bi bi-bar-chart-line me-2"></i>昨日市场总结
                </div>
                <div class="market-summary-content">
                    {% if market_summary and market_summary.dify_answer_html %}
                    {# 使用 dify_answer_html 并标记为 safe #}
                    {{ market_summary.dify_answer_html|safe }}
                    {% else %}
                    <div class="text-muted">
                        <i class="bi bi-hourglass-split me-2"></i>
                        今日市场数据正在分析中，请稍后查看...
                    </div>
                    {% endif %}
                </div>
                <div class="market-summary-meta">
                    <div>
                        <i class="bi bi-clock me-1"></i>
                        {{ market_summary.created_at.strftime('%Y-%m-%d %H:%M') if market_summary else '--:--' }}
                    </div>
                    <div>
                        <span class="badge bg-light bg-opacity-25">
                            <i class="bi bi-robot me-1"></i>AI生成
                        </span>
                    </div>
                </div>
            </div>

            <!-- 全球热点 -->
            <h3 class="section-title">
                <i class="bi bi-globe"></i> 全球热点
            </h3>
            <div class="global-hot-news">
                {% if global_news_list %}
                {% for item in global_news_list %}
                <div class="global-hot-item mb-2 p-2 border-start border-3 border-primary bg-light rounded">
                    <small class="text-muted">{{ item.publish_time.strftime('%m-%d %H:%M') }}</small>
                    <p class="mb-0">{{ item.content | truncate(100) }}</p>
                </div>
                {% endfor %}
                {% else %}
                <div class="text-muted">暂无全球热点资讯</div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- 刷新提示框容器 -->
<div class="toast-container">
    <div id="refreshToast" class="toast refresh-toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-body">
            <i class="bi bi-check-circle-fill"></i>
            <span>已催促更新...</span>
        </div>
        <div class="toast-progress"></div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // 设置初始时间
        updateTimeDisplay();

        const refreshBtn = document.getElementById('refreshNews');
        const refreshToast = document.getElementById('refreshToast');
        let toastTimeout;

        function showRefreshToast() {
            if (!refreshToast) return;

            // 清除之前的定时器
            if (toastTimeout) {
                clearTimeout(toastTimeout);
            }

            // 移除所有动画类
            refreshToast.classList.remove('show', 'hiding');

            // 强制重绘
            void refreshToast.offsetWidth;

            // 添加进场动画
            refreshToast.classList.add('show');

            // 重置进度条动画
            const progressBar = refreshToast.querySelector('.toast-progress');
            if (progressBar) {
                progressBar.style.animation = 'none';
                void progressBar.offsetWidth;
                progressBar.style.animation = 'toastProgress 3s linear forwards';
            }

            // 3秒后开始退场动画
            toastTimeout = setTimeout(() => {
                hideRefreshToast();
            }, 3000);
        }

// 隐藏提示框的函数
        function hideRefreshToast() {
            if (!refreshToast) return;

            // 清除定时器
            if (toastTimeout) {
                clearTimeout(toastTimeout);
                toastTimeout = null;
            }

            // 添加退场动画类
            refreshToast.classList.add('hiding');
            refreshToast.classList.remove('show');

            // 动画完成后完全隐藏
            setTimeout(() => {
                refreshToast.classList.remove('hiding');
            }, 400); // 匹配CSS退场动画时长
        }

// 点击提示框可手动关闭
        refreshToast?.addEventListener('click', function () {
            hideRefreshToast();
        });

// 刷新按钮功能
        refreshBtn?.addEventListener('click', function () {
            const button = this;
            const icon = button.querySelector('.bi-arrow-clockwise');

            button.disabled = true;
            icon.style.animation = 'rotate 1s linear infinite';

            // 模拟刷新过程
            setTimeout(() => {
                button.disabled = false;
                icon.style.animation = '';

                // 更新时间显示
                const now = new Date();
                const timeString = now.toLocaleString('zh-CN', {
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                const updateTimeEl = document.getElementById('updateTime');
                if (updateTimeEl) {
                    updateTimeEl.textContent = timeString;
                }

                // 显示成功提示
                showRefreshToast();

                console.log('新闻数据已刷新');
            }, 1500);
        });

        // 卡片悬停效果（保留）
        const cards = document.querySelectorAll('.news-card, .market-summary-card');
        cards.forEach(card => {
            card.addEventListener('mouseenter', function () {
                this.style.transform = 'translateY(-8px) scale(1.02)';
            });
            card.addEventListener('mouseleave', function () {
                this.style.transform = 'translateY(-5px) scale(1)';
            });
        });

        // 更新时间（如果未设置）
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            const updateTimeEl = document.getElementById('updateTime');
            if (updateTimeEl && !updateTimeEl.textContent.trim()) {
                updateTimeEl.textContent = timeString;
            }
        }

        updateCurrentTime();
    });

    // 添加更新时间显示的函数
    function updateTimeDisplay() {
        const updateTimeEl = document.getElementById('updateTime');
        if (updateTimeEl) {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN', {
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            updateTimeEl.textContent = timeString;
        }
    }
</script>
{% endblock %}